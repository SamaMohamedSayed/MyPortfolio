<div class="dashboard-cards">
    <div class="cards-grid">
        <div class="card" *ngFor="let project of projects; let i = index">

        <img *ngIf="projectId !== project._id" [src]="'http://localhost:4000/images/' + project.cover" alt="cover" class="cover">

        <div class="card-body" *ngIf="projectId !== project._id; else editForm">
            <h3>{{ project.title }}</h3>
            <p>{{ project.description }}</p>
            <p><strong>Created:</strong> {{ project.createdAt | date }}</p>
            <p><strong>Role:</strong> {{ project.role }}</p>
            <p><strong>Technologies:</strong> {{ project.technologies }}</p>
            <p><strong>Images:</strong> {{ project.images?.length || 0 }}</p>
        </div>

        <ng-template #editForm>
            <form [formGroup]="myForm" class="p-2" (ngSubmit)="submitEdit()">
                <label>Cover</label>
            <input type="file" (change)="onCoverSelect($event)" class="form-control">
            <input type="text" formControlName="title" placeholder="Title" class="form-control">
            <textarea formControlName="description" placeholder="Description" class="form-control"></textarea>
            <input type="text" formControlName="role" placeholder="Role" class="form-control">
            <input type="text" formControlName="technologies" placeholder="Technologies" class="form-control">
            <input type="text" formControlName="url" placeholder="Project's URL" class="form-control">
            <input type="text" formControlName="createdAt" placeholder="Created at" class="form-control">
            <label>Images</label>
            <input type="file" (change)="onImagesSelect($event)" multiple class="form-control">

            <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </ng-template>

        <div class="card-actions" *ngIf="projectId !== project._id">
            <button class="btn-edit" (click)="editProject(project._id)">Edit</button>
            <button class="btn-delete" (click)="deleteProject(project._id, i)">Delete</button>
        </div>
        </div>
    </div>

    <div class="add" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    +
    </div>

    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
        <div class="modal-header">
            <h1 class="modal-title text-center fs-5" id="staticBackdropLabel">Add Service</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <form action="" [formGroup]="myForm" (ngSubmit)="submit()">
                <label>Cover</label>
                <input type="file" (change)="onCoverSelect($event)" class="form-control">
                <input type="text" formControlName="title" placeholder="Title" class="form-control">
                <div *ngIf="myForm.get('title')?.invalid">hhhh</div>
                <textarea formControlName="description" placeholder="Description" class="form-control"></textarea>
                <input type="text" formControlName="role" placeholder="Role" class="form-control">
                <input type="text" formControlName="technologies" placeholder="Technologies" class="form-control">
                <input type="text" formControlName="url" placeholder="Project's URL" class="form-control">
                <input type="date" formControlName="createdAt" placeholder="Created at" class="form-control">

                <label>Images</label>
                <input type="file" (change)="onImagesSelect($event)" accept="image/*" multiple class="form-control">
                <div class="text-center my-3">
                    <button class="btn btn-primary px-5">Add</button>
                </div>
            </form>
        </div>
        
        </div>
    </div>
    </div>
</div>
